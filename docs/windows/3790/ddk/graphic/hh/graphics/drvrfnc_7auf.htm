<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>IPrintOemUI2::DocumentEvent</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="IPrintOemUI2::DocumentEvent">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Display&nbsp;and&nbsp;Print&nbsp;Devices:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_iprintoemui2_documentevent_gg"></A>IPrintOemUI2::DocumentEvent</H1>

<P>The <B>IPrintOemUI2::DocumentEvent</B> method allows a UI plug-in to replace the core driver UI module's default implementation of the <A HREF="drvrfnc_9c4n.htm"><B>DrvDocumentEvent</B></A> DDI.</P>

<PRE class=syntax><B>STDMETHOD
</B>  <B>(DocumentEvent) (</B>
    <B>THIS_</B>
    <B>IN HANDLE</B>  <I>hPrinter</I>,
    <B>IN HDC</B>  <I>hdc</I>,
    <B>IN INT</B>  <I>iEsc</I>,
    <B>IN ULONG</B>  <I>cbIn</I>,
    <B>IN PVOID</B>  <I>pvIn</I>,
    <B>IN ULONG</B>  <I>cbOut</I>,
    <B>OUT PVOID</B> <I>pvOut</I>,
    <B>OUT PINT</B>  <I>piResult</I>
    <B>) PURE;</B></PRE>

<H4>Parameters</H4>

<DL>
<DT><I>hPrinter</I></DT>

<DD>Is a caller-supplied printer handle.</DD>

<DT><I>hdc</I></DT>

<DD>Is a caller-supplied device context handle, generated by a <B>CreateDC</B> call. This is zero if <I>iEsc</I> is DOCUMENTEVENT_CREATEDCPRE.</DD>

<DT><I>iEsc</I></DT>

<DD>Is a caller-supplied escape code identifying the event to be handled. This parameter can be one of the following integer constants:

<TABLE>

<TR VALIGN="top">
<TH align=left width=57%>Escape Code</TH>
<TH align=left width=43%>Meaning</TH>
</TR>

<TR VALIGN="top">
<TD width=57%>DOCUMENTEVENT_ABORTDOC</TD>
<TD width=43%>GDI is about to process a call to its <B>AbortDoc</B> function.</TD>
</TR>

<TR VALIGN="top">
<TD width=57%>DOCUMENTEVENT_CREATEDCPOST</TD>
<TD width=43%>GDI has just processed a call to its <B>CreateDC</B> or <B>CreateIC</B> function.<BR>
This escape code should not be used unless there has been a previous call to <B>DrvDocumentEvent</B> with <I>iEsc</I> set to DOCUMENTEVENT_CREATEDCPRE.</TD>
</TR>

<TR VALIGN="top">
<TD width=57%>DOCUMENTEVENT_CREATEDCPRE</TD>
<TD width=43%>GDI is about to process a call to its <B>CreateDC</B> or <B>CreateIC</B> function.</TD>
</TR>

<TR VALIGN="top">
<TD width=57%>DOCUMENTEVENT_DELETEDC</TD>
<TD width=43%>GDI is about to process a call to its <B>DeleteDC</B> function.</TD>
</TR>

<TR VALIGN="top">
<TD width=57%>DOCUMENTEVENT_ENDDOCPOST</TD>
<TD width=43%>GDI has just processed a call to its <B>EndDoc</B> function.</TD>
</TR>

<TR VALIGN="top">
<TD width=57%>DOCUMENTEVENT_ENDDOCPRE<BR>
<I>or</I> DOCUMENTEVENT_ENDDOC</TD>
<TD width=43%>GDI is about to process a call to its <B>EndDoc</B> function.</TD>
</TR>

<TR VALIGN="top">
<TD width=57%>DOCUMENTEVENT_ENDPAGE</TD>
<TD width=43%>GDI is about to process a call to its <B>EndPage</B> function.</TD>
</TR>

<TR VALIGN="top">
<TD width=57%>DOCUMENTEVENT_ESCAPE</TD>
<TD width=43%>GDI is about to process a call to its <B>ExtEscape</B> function.</TD>
</TR>

<TR VALIGN="top">
<TD width=57%>DOCUMENTEVENT_QUERYFILTER</TD>
<TD width=43%>The DOCUMENTEVENT_QUERYFILTER event represents an opportunity for the spooler to query the driver for a list of the DOCUMENTEVENT_<I>XXX</I> events to which the driver will respond. This event is issued just prior to a call to <B>DrvDocumentEvent</B> that passes the DOCUMENTEVENT_CREATEDCPRE event.</TD>
</TR>

<TR VALIGN="top">
<TD width=57%>DOCUMENTEVENT_RESETDCPOST</TD>
<TD width=43%>GDI has just processed a call to its <B>ResetDC</B> function.<BR>
This escape code should not be used unless there has been a previous call to <B>DrvDocumentEvent</B> with <I>iEsc</I> set to DOCUMENTEVENT_RESETDCPRE.</TD>
</TR>

<TR VALIGN="top">
<TD width=57%>DOCUMENTEVENT_RESETDCPRE</TD>
<TD width=43%>GDI is about to process a call to its <B>ResetDC</B> function.</TD>
</TR>

<TR VALIGN="top">
<TD width=57%>DOCUMENTEVENT_STARTDOCPOST</TD>
<TD width=43%>GDI has just processed a call to its <B>StartDoc</B> function.</TD>
</TR>

<TR VALIGN="top">
<TD width=57%>DOCUMENTEVENT_STARTDOCPRE<BR>
<I>or</I> DOCUMENTEVENT_STARTDOC</TD>
<TD width=43%>GDI is about to process a call to its <B>StartDoc</B> function.</TD>
</TR>

<TR VALIGN="top">
<TD width=57%>DOCUMENTEVENT_STARTPAGE</TD>
<TD width=43%>GDI is about to process a call to its <B>StartPage</B> function.</TD>
</TR>
</TABLE><BR>

</DD>

<DT><I>cbIn</I></DT>

<DD>Is the caller-supplied size, in bytes, of the buffer pointed to by <I>pvIn</I>.</DD>

<DT><I>pvIn</I></DT>

<DD>Caller-supplied pointer, the use of which is dependent on the value supplied for <I>iEsc</I>, as follows:

<TABLE>

<TR VALIGN="top">
<TH align=left width=59%><I>iEsc</I> Constant</TH>
<TH align=left width=41%><I>pvIn</I> Contents</TH>
</TR>

<TR VALIGN="top">
<TD width=59%>DOCUMENTEVENT_ABORTDOC</TD>
<TD width=41%>Not used.</TD>
</TR>

<TR VALIGN="top">
<TD width=59%>DOCUMENTEVENT_CREATEDCPOST</TD>
<TD width=41%><I>pvIn</I> contains the address of a pointer to the <A HREF="grstrcts_6v8n.htm">DEVMODE</A> structure specified in the <I>pvOut</I> parameter in a previous call to this function, for which the <I>iEsc</I> parameter was set to DOCUMENTEVENT_CREATEDCPRE.</TD>
</TR>

<TR VALIGN="top">
<TD width=59%>DOCUMENTEVENT_CREATEDCPRE</TD>
<TD width=41%><I>pvIn </I>points to a <A HREF="drvrfnc_6rvr.htm">DOCEVENT_CREATEDCPRE</A> structure.</TD>
</TR>

<TR VALIGN="top">
<TD width=59%>DOCUMENTEVENT_DELETEDC</TD>
<TD width=41%>Not used.</TD>
</TR>

<TR VALIGN="top">
<TD width=59%>DOCUMENTEVENT_ENDDOCPOST</TD>
<TD width=41%>Not used.</TD>
</TR>

<TR VALIGN="top">
<TD width=59%>DOCUMENTEVENT_ENDDOCPRE<BR>
<I>or</I> DOCUMENTEVENT_ENDDOC</TD>
<TD width=41%>Not used.</TD>
</TR>

<TR VALIGN="top">
<TD width=59%>DOCUMENTEVENT_ENDPAGE</TD>
<TD width=41%>Not used.</TD>
</TR>

<TR VALIGN="top">
<TD width=59%>DOCUMENTEVENT_ESCAPE</TD>
<TD width=41%><I>pvIn</I> points to a <A HREF="drvrfnc_6j3b.htm">DOCEVENT_ESCAPE</A> structure.</TD>
</TR>

<TR VALIGN="top">
<TD width=59%>DOCUMENTEVENT_QUERYFILTER</TD>
<TD width=41%>Same as for DOCUMENTEVENT_CREATEDCPRE.</TD>
</TR>

<TR VALIGN="top">
<TD width=59%>DOCUMENTEVENT_RESETDCPOST</TD>
<TD width=41%><I>pvIn</I> contains the address of a pointer to the <A HREF="grstrcts_6v8n.htm">DEVMODE</A> structure specified in the <I>pvOut</I> parameter in a previous call to this function, for which the <I>iEsc</I> parameter was set to DOCUMENTEVENT_RESETDCPRE.</TD>
</TR>

<TR VALIGN="top">
<TD width=59%>DOCUMENTEVENT_RESETDCPRE</TD>
<TD width=41%><I>pvIn</I> contains the address of a pointer to a <A HREF="grstrcts_6v8n.htm">DEVMODE</A> structure supplied by the caller of <B>ResetDC</B> (described in the Platform SDK documentation).</TD>
</TR>

<TR VALIGN="top">
<TD width=59%>DOCUMENTEVENT_STARTDOCPOST</TD>
<TD width=41%><I>pvIn</I> points to a LONG that specifies the print job identifier returned by <B>StartDoc</B> (described in the Platform SDK documentation).</TD>
</TR>

<TR VALIGN="top">
<TD width=59%>DOCUMENTEVENT_STARTDOCPRE<BR>
<I>or</I> DOCUMENTEVENT_STARTDOC</TD>
<TD width=41%><I>pvIn</I> contains the address of a pointer to a DOCINFO structure supplied by the caller of <B>StartDoc</B> (both described in the Platform SDK documentation). </TD>
</TR>

<TR VALIGN="top">
<TD width=59%>DOCUMENTEVENT_STARTPAGE</TD>
<TD width=41%>Not used.</TD>
</TR>
</TABLE><BR>

</DD>

<DT><I>cbOut</I></DT>

<DD>

<DL>
<DT>If <I>iEsc</I> is DOCUMENTEVENT_ESCAPE:</DT>

<DD>Function-supplied value that is used as the <I>cbOutput</I> parameter for <B>ExtEscape</B>.</DD>

<DT>If <I>iEsc</I> is DOCUMENTEVENT_QUERYFILTER:</DT>

<DD>Caller-supplied size, in bytes, of the buffer pointer to by <I>pvOut</I>.</DD>

<DT>For all other <I>iEsc</I> values:</DT>

<DD>Not used.</DD>
</DL>
</DD>

<DT><I>pvOut</I></DT>

<DD>Is a function-supplied pointer to an output buffer, the use of which is dependent on the value supplied for <I>iEsc</I>, as follows. <B>CreateDC</B>, <B>ExtEscape</B>, and <B>ResetDC</B> are described in the Platform SDK documentation.

<TABLE>

<TR VALIGN="top">
<TH align=left width=55%><I>iEsc</I> Constant</TH>
<TH align=left width=45%><I>pvOut</I> Contents</TH>
</TR>

<TR VALIGN="top">
<TD width=55%>DOCUMENTEVENT_CREATEDCPRE</TD>
<TD width=45%>Pointer to a driver-supplied DEVMODE structure, which GDI uses instead of the one supplied by the <B>CreateDC</B> caller. (If NULL, GDI uses the caller-supplied structure.)</TD>
</TR>

<TR VALIGN="top">
<TD width=55%>DOCUMENTEVENT_ESCAPE</TD>
<TD width=45%>Buffer pointer that is used as the <I>lpszOutData</I> parameter for <B>ExtEscape</B>.</TD>
</TR>

<TR VALIGN="top">
<TD width=55%>DOCUMENTEVENT_QUERYFILTER</TD>
<TD width=45%>Caller-supplied pointer to buffer containing a <A HREF="drvrfnc_29wn.htm">DOCEVENT_FILTER</A> structure.</TD>
</TR>

<TR VALIGN="top">
<TD width=55%>DOCUMENTEVENT_RESETDCPRE</TD>
<TD width=45%>Pointer to a driver-supplied DEVMODE structure, which GDI uses instead of the one supplied by the <B>ResetDC</B> caller. (If NULL, GDI uses the caller-supplied structure.)</TD>
</TR>

<TR VALIGN="top">
<TD width=55%>All other <I>iEsc</I> values</TD>
<TD width=45%>Not used.</TD>
</TR>
</TABLE><BR>

</DD>

<DT><I>piResult</I></DT>

<DD>Pointer to a memory location that receives one of the following values:

<TABLE>

<TR VALIGN="top">
<TH align=left width=48%>Return Value</TH>
<TH align=left width=52%>Definition</TH>
</TR>

<TR VALIGN="top">
<TD width=48%>DOCUMENTEVENT_FAILURE</TD>
<TD width=52%>The driver supports the escape code identified by <I>iEsc</I>, but a failure occurred.</TD>
</TR>

<TR VALIGN="top">
<TD width=48%>DOCUMENTEVENT_SUCCESS</TD>
<TD width=52%>The driver successfully handled the escape code identified by <I>iEsc</I>. Also see the <B>Comments</B> section for more information.</TD>
</TR>

<TR VALIGN="top">
<TD width=48%>DOCUMENTEVENT_UNSUPPORTED</TD>
<TD width=52%>The driver does not support the escape code identified by <I>iEsc</I>.</TD>
</TR>
</TABLE><BR>


</DD>
</DL>

<H4>Return Value</H4>

<P>This method should return one of the following values. See the <B>Comments</B> section for more information.</P>

<TABLE>

<TR VALIGN="top">
<TH align=left width=48%>Value</TH>
<TH align=left width=52%>Meaning</TH>
</TR>

<TR VALIGN="top">
<TD width=48%>S_OK</TD>
<TD width=52%>The UI plug-in implements this method.</TD>
</TR>

<TR VALIGN="top">
<TD width=48%>E_NOTIMPL</TD>
<TD width=52%>The UI plug-in does not implement this method.</TD>
</TR>
</TABLE><BR>

<H4>Headers</H4>

<P>Declared in <I>prcomoem.h</I>. Include <I>prcomoem.h</I>.</P>

<H4>Comments</H4>

<P>A user interface plug-in’s <B>IPrintOemUI2::DocumentEvent</B> method performs the same types of operations as the <B>DrvDocumentEvent</B> DDI that is exported by user-mode printer interface DLLs. For information about document events and how they should be processed, see the description of the <A HREF="drvrfnc_9c4n.htm"><B>DrvDocumentEvent</B></A> DDI.</P>

<P>If you provide a user interface plug-in, the printer driver’s <B>DrvDocumentEvent</B> DDI calls the <B>IPrintOemUI2::DocumentEvent</B> method. The <B>DrvDocumentEvent</B> DDI performs its own processing for the specified event, and then calls the <B>IPrintOemUI2::DocumentEvent</B> method to handle additional processing of the event.</P>

<P>When this method is called with a value of the <I>iEsc</I> parameter of DOCUMENTEVENT_QUERYFILTER, and returns with *<I>piResult</I> == DOCUMENTEVENT_SUCCESS, the spooler can interpret this value in either of two ways, depending on whether certain members of the <A HREF="drvrfnc_29wn.htm">DOCEVENT_FILTER</A> structure changed values. For more information, see the <B>Comments</B> section for <A HREF="drvrfnc_9c4n.htm"><B>DrvDocumentEvent</B></A>.</P>

<P>When the DOCUMENTEVENT_QUERYFILTER event is fired, the core driver calls plug-ins in the order they were installed, until one of them returns S_OK, or until all of the plug-ins have been called and none of them returned S_OK. In this way, at most one plug-in is allowed to handle the DOCUMENTEVENT_QUERYFILTER event, and the filter it specifies is applied to all plug-ins in the plug-in chain.</P>

<P>For a plug-in writer who is implementing the <B>IPrintOemUI2</B> interface, but does not need to support the <B>IPrintOemUI2::DocumentEvent</B> method, this method should return E_NOTIMPL for all values of <I>iEsc</I>. If you do need to implement this method, it should return S_OK for all values of <I>iEsc</I>. This signals the core driver that this method has handled the relevant event. The core driver uses the value that this method places in <I>piResult</I> as the return value for the <A HREF="drvrfnc_9c4n.htm"><B>DrvDocumentEvent</B></A> DDI.</P>

<H4>See Also</H4>

<P><A HREF="drvrfnc_9c4n.htm"><B>DrvDocumentEvent</B></A>, <A HREF="drvrfnc_29wn.htm">DOCEVENT_FILTER</A>, <A HREF="drvrfnc_6rvr.htm">DOCEVENT_CREATEDCPRE</A>, <A HREF="drvrfnc_6j3b.htm">DOCEVENT_ESCAPE</A></P>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: IPrintOemUI2::DocumentEvent"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
