<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Using Device Installation Functions</TITLE>
<SCRIPT SRC="../scripts/linkcss.js"></SCRIPT><SCRIPT SRC="../scripts/langref.js"></SCRIPT><META NAME="MS-HKWD" CONTENT="Using Device Installation Functions">
</HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0>
<TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Device&nbsp;Installation:&nbsp;Windows&nbsp;DDK</TD></TR>
</TABLE>
<H1><A NAME="ddk_using_device_installation_functions_dg"></A>Using Device Installation Functions</H1>

<P>This section summarizes the <A HREF="di-rtns_85ma.htm">device installation functions</A>. The types of operations that installation software can perform using these functions include:

<UL>
	<LI>Handling DIF codes</LI>

	<LI>Managing device information sets</LI>

	<LI>Managing driver lists</LI>

	<LI>Managing device interfaces</LI>

	<LI>Managing icons and other bitmaps</LI>
</UL>

<P>To perform device installation operations that are not supported by the <B>SetupDi</B>-prefixed functions described in this section, call the appropriate <A HREF="setup-ref_1r3m.htm">general setup functions</A> and <A HREF="cfgmgrfn_88oi.htm">PnP Configuration Manager Functions</A> (CM_<I>Xxx</I> functions<I>).</I></P>

<P>The following tables provide summaries of the functions:</P>

<P class=indent1><A HREF="#ddk_update_driver_function_dg">Update Driver Function</A> </P>

<P class=indent1><A HREF="#ddk_setupdi_device_information_functions_dg">Device Information Functions</A> </P>

<P class=indent1><A HREF="#ddk_setupdi_driver_information_functions_dg">Driver Information Functions</A> </P>

<P class=indent1><A HREF="#ddk_setupdi_driver_selection_functions_dg">Driver Selection Functions</A> </P>

<P class=indent1><A HREF="#ddk_setupdi_device_installation_handlers_dg">Device Installation Handlers</A> </P>

<P class=indent1><A HREF="#ddk_setupdi_device_installation_customization_functions_dg">Device Installation Customization Functions</A> </P>

<P class=indent1><A HREF="#ddk_setupdi_setup_class_functions_dg">Setup Class Functions</A> </P>

<P class=indent1><A HREF="#ddk_setupdi_class_bitmap_and_icon_functions_dg">Class Bitmap and Icon Functions</A> </P>

<P class=indent1><A HREF="#ddk_setupdi_device_interface_functions_dg">Device Interface Functions</A> </P>

<P class=indent1><A HREF="#ddk_setupdi_registry_functions_dg">Registry Functions</A> </P>

<P class=indent1><A HREF="#ddk_other_setupdi_functions_dg">Other Functions</A> </P>



<H4><A NAME="ddk_update_driver_function_dg"></A>Update Driver Function </H4>

<TABLE>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_01ki.htm"><B>UpdateDriverForPlugAndPlayDevices</B></A>  </TD>
<TD width=46%>Given an INF and a hardware ID, <B>UpdateDriverForPlugAndPlayDevices</B> installs updated drivers for devices that match the hardware ID. </TD>
</TR>
</TABLE><BR>



<H4><A NAME="ddk_setupdi_device_information_functions_dg"></A>SetupDi Device Information Functions </H4>

<TABLE>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_2iya.htm"><B>SetupDiCreateDeviceInfoList</B></A> </TD>
<TD width=46%>Creates an empty <A HREF="setup-cls_2h9j.htm">device information set</A>. This set can be associated with a class GUID.</TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_6qr6.htm"><B>SetupDiCreateDeviceInfoListEx</B></A></TD>
<TD width=46%>Creates an empty device information set. This set can be associated with a class GUID and can be for devices on a remote machine.</TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_75gy.htm"><B>SetupDiCreateDeviceInfo</B></A> </TD>
<TD width=46%>Creates a new device information element and adds it as a new member to the specified device information set.</TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_8n02.htm"><B>SetupDiOpenDeviceInfo</B></A> </TD>
<TD width=46%>Retrieves information about an existing device instance and adds it to the specified device information set. </TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_8z5e.htm"><B>SetupDiEnumDeviceInfo</B></A> </TD>
<TD width=46%>Returns a context structure for a device information element of a device information set.</TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_69de.htm"><B>SetupDiGetDeviceInstanceId</B></A> </TD>
<TD width=46%>Retrieves the device instance ID associated with a device information element.</TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_78c2.htm"><B>SetupDiGetDeviceInfoListClass</B></A> </TD>
<TD width=46%>Retrieves the class GUID associated with a device information set if it has an associated class.</TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_8j5e.htm"><B>SetupDiGetDeviceInfoListDetail</B></A> </TD>
<TD width=46%>Retrieves information associated with a device information set including the class GUID, remote machine handle, and remote machine name.</TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_7a0i.htm"><B>SetupDiGetClassDevPropertySheets</B></A></TD>
<TD width=46%>Retrieves handles to the property sheets of a specified device information element or of the device setup class of a specified device information set.</TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_9ks2.htm"><B>SetupDiGetClassDevs</B></A> </TD>
<TD width=46%>Returns a device information set that contains all devices of a specified class.</TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_6msy.htm"><B>SetupDiGetClassDevsEx</B></A> </TD>
<TD width=46%>Returns a device information set that contains all devices of a specified class on a local or remote machine.</TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_7xwy.htm"><B>SetupDiSetSelectedDevice</B></A> </TD>
<TD width=46%>Sets the specified device information element to be the currently-selected member of a device information set. This function is typically used by an installation wizard.</TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_19bm.htm"><B>SetupDiGetSelectedDevice</B></A> </TD>
<TD width=46%>Retrieves the currently-selected device for the specified device information set.</TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_2epe.htm"><B>SetupDiRegisterDeviceInfo</B></A> </TD>
<TD width=46%>Registers a newly created device instance with the Plug and Play Manager.</TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_1436.htm"><B>SetupDiDeleteDeviceInfo</B></A> </TD>
<TD width=46%>Deletes a member from the specified device information set. This function does not delete the actual device.</TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_0z8y.htm"><B>SetupDiDestroyDeviceInfoList</B></A> </TD>
<TD width=46%>Destroys a device information set and frees all associated memory.</TD>
</TR>
</TABLE><BR>



<H4><A NAME="ddk_setupdi_driver_information_functions_dg"></A>SetupDi Driver Information Functions </H4>

<TABLE>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_9pma.htm"><B>SetupDiBuildDriverInfoList</B></A> </TD>
<TD width=46%>Builds a list of drivers associated with a specified device instance or with the device information set's global class driver list. </TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_36r6.htm"><B>SetupDiEnumDriverInfo</B></A> </TD>
<TD width=46%>Enumerates the members of a driver information list.</TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_64tu.htm"><B>SetupDiGetDriverInfoDetail</B></A> </TD>
<TD width=46%>Retrieves detailed information for a specified driver information element.</TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_5d2q.htm"><B>SetupDiSetSelectedDriver</B></A> </TD>
<TD width=46%>Sets the specified member of a driver list as the currently selected-driver. It can also be used to reset the driver list so that there is no currently-selected driver.</TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_8ohe.htm"><B>SetupDiGetSelectedDriver</B></A> </TD>
<TD width=46%>Retrieves the member of a driver list that has been selected as the driver to install.</TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_6nhu.htm"><B>SetupDiCancelDriverInfoSearch</B></A> </TD>
<TD width=46%>Cancels a driver list search that is currently underway in a different thread. </TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_33aq.htm"><B>SetupDiDestroyDriverInfoList</B></A> </TD>
<TD width=46%>Destroys a driver information list.</TD>
</TR>
</TABLE><BR>



<H4><A NAME="ddk_setupdi_driver_selection_functions_dg"></A>SetupDi Driver Selection Functions </H4>

<TABLE>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_2nsi.htm"><B>SetupDiAskForOEMDisk</B></A> </TD>
<TD width=46%>Displays a dialog that asks the user for the path to an OEM installation disk.</TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_584y.htm"><B>SetupDiSelectOEMDrv</B></A> </TD>
<TD width=46%>Selects a driver for a device using an OEM path supplied by the user.</TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_6fle.htm"><B>SetupDiSelectDevice</B></A> </TD>
<TD width=46%>Default handler for the DIF_SELECTDEVICE request.</TD>
</TR>
</TABLE><BR>



<H4><A NAME="ddk_setupdi_device_installation_handlers_dg"></A>SetupDi Device Installation Handlers </H4>

<TABLE>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_7fjm.htm"><B>SetupDiCallClassInstaller</B></A> </TD>
<TD width=46%>Calls the appropriate class installer, and any registered co-installers, with the specified installation request.</TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_212q.htm"><B>SetupDiChangeState</B></A> </TD>
<TD width=46%>The default handler for the DIF_PROPERTYCHANGE request. It can be used to change the state of an installed device.</TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_0z1u.htm"><B>SetupDiRegisterCoDeviceInstallers</B></A></TD>
<TD width=46%>Registers the device-specific co-installers listed in the INF file for the specified device. This function is the default handler for DIF_REGISTER_COINSTALLERS. </TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_3f8y.htm"><B>SetupDiInstallDevice</B></A> </TD>
<TD width=46%>The default handler for the DIF_INSTALLDEVICE request. </TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_5tyq.htm"><B>SetupDiInstallDriverFiles</B></A> </TD>
<TD width=46%>The default handler for the DIF_INSTALLDEVICEFILES request. </TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_1v5e.htm"><B>SetupDiInstallDeviceInterfaces</B></A></TD>
<TD width=46%>The default handler for the DIF_INSTALLINTERFACES request. It installs the interfaces listed in a <I>DDInstall</I>.<B>Interfaces</B> section of a device INF file.</TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_4b1u.htm"><B>SetupDiMoveDuplicateDevice</B></A> </TD>
<TD width=46%>This function is obsolete and can not be used in any version of Microsoft® Windows®. The default handler for the DIF_MOVEDEVICE request. </TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_5fua.htm"><B>SetupDiRemoveDevice</B></A> </TD>
<TD width=46%>The default handler for the DIF_REMOVEDEVICE request.</TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_11pu.htm"><B>SetupDiUnremoveDevice</B></A> </TD>
<TD width=46%>The default handler for the DIF_UNREMOVE request.</TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_2epe.htm"><B>SetupDiRegisterDeviceInfo</B></A> </TD>
<TD width=46%>The default handler for the DIF_REGISTERDEVICE request.</TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_6fle.htm"><B>SetupDiSelectDevice</B></A> </TD>
<TD width=46%>The default handler for the DIF_SELECTDEVICE request.</TD>
</TR>

<TR VALIGN="top">
<TD width=54%> <A HREF="di-rtns_2gvm.htm"><B>SetupDiSelectBestCompatDrv</B></A></TD>
<TD width=46%>The default handler for the DIF_SELECTBESTCOMPATDRV request.</TD>
</TR>
</TABLE><BR>



<H4><A NAME="ddk_setupdi_device_installation_customization_functions_dg"></A>SetupDi Device Installation Customization Functions </H4>

<TABLE>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_11iq.htm"><B>SetupDiGetClassInstallParams</B></A> </TD>
<TD width=46%>Retrieves class install parameters for a device information set or a particular device information element. </TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_5vg2.htm"><B>SetupDiSetClassInstallParams</B></A> </TD>
<TD width=46%>Sets or clears class install parameters for a device information set or a particular device information element. </TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_0h2q.htm"><B>SetupDiGetDeviceInstallParams</B></A> </TD>
<TD width=46%>Retrieves device install parameters for a device information set or a particular device information element.</TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_9oc2.htm"><B>SetupDiSetDeviceInstallParams</B></A> </TD>
<TD width=46%>Sets device install parameters for a device information set or a particular device information element.</TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_2goi.htm"><B>SetupDiGetDriverInstallParams</B></A> </TD>
<TD width=46%>Retrieves install parameters for the specified driver.</TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_1nxu.htm"><B>SetupDiSetDriverInstallParams</B></A> </TD>
<TD width=46%>Sets the install parameters for the specified driver.</TD>
</TR>
</TABLE><BR>



<H4><A NAME="ddk_setupdi_setup_class_functions_dg"></A>SetupDi Setup Class Functions </H4>

<TABLE>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_5awi.htm"><B>SetupDiBuildClassInfoList</B></A> </TD>
<TD width=46%>Returns a list of setup class GUIDs that includes every class installed on the system.</TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_8whe.htm"><B>SetupDiBuildClassInfoListEx</B></A></TD>
<TD width=46%>Returns a list of setup class GUIDs that includes every class installed on the local system or a remote system.</TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_4l4i.htm"><B>SetupDiGetClassDescription</B></A> </TD>
<TD width=46%>Retrieves the class description associated with the specified setup class GUID.</TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_5ype.htm"><B>SetupDiGetClassDescriptionEx</B></A> </TD>
<TD width=46%>Retrieves the description of a setup class installed on a local or remote machine.</TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_6u42.htm"><B>SetupDiGetINFClass</B></A> </TD>
<TD width=46%>Retrieves the class of a specified device INF file.</TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_3z02.htm"><B>SetupDiClassGuidsFromName</B></A> </TD>
<TD width=46%>Retrieves the GUIDs associated with the specified class name. This list is built based on what classes are currently installed on the system.</TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_8t0y.htm"><B>SetupDiClassGuidsFromNameEx</B></A> </TD>
<TD width=46%>Retrieves the GUIDs associated with the specified class name. This resulting list contains the classes currently installed on a local or remote machine.</TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_1j3m.htm"><B>SetupDiClassNameFromGuid</B></A> </TD>
<TD width=46%>Retrieves the class name associated with the class GUID.</TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_7lki.htm"><B>SetupDiClassNameFromGuidEx</B></A> </TD>
<TD width=46%>Retrieves the class name associated with a class GUID. The class can be installed on a local or remote machine.</TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_6dwy.htm"><B>SetupDiInstallClass</B></A> </TD>
<TD width=46%>Installs the <B>ClassInstall32</B> section of the specified INF file.</TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_7n1u.htm"><B>SetupDiInstallClassEx</B></A></TD>
<TD width=46%>Installs a class installer or an interface class.</TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_26pe.htm"><B>SetupDiOpenClassRegKey</B></A></TD>
<TD width=46%>Opens the device setup class registry key or a specific class's subkey.</TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_3bea.htm"><B>SetupDiOpenClassRegKeyEx</B></A></TD>
<TD width=46%>Opens the device setup class registry key, the device interface class registry key, or a specific class's subkey. This function opens the specified key on the local machine or on a remote machine.</TD>
</TR>
</TABLE><BR>



<H4><A NAME="ddk_setupdi_class_bitmap_and_icon_functions_dg"></A>SetupDi Class Bitmap and Icon Functions </H4>

<TABLE>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_6dte.htm"><B>SetupDiGetClassImageList</B></A> </TD>
<TD width=46%>Builds an image list that contains bitmaps for every installed class and returns the list in a data structure.</TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_6eia.htm"><B>SetupDiGetClassImageListEx</B></A> </TD>
<TD width=46%>Builds an image list of bitmaps for every class installed on a local or remote machine.</TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_8acy.htm"><B>SetupDiGetClassImageIndex</B></A> </TD>
<TD width=46%>Retrieves the index within the class image list of a specified class.</TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_9xpu.htm"><B>SetupDiGetClassBitmapIndex</B></A> </TD>
<TD width=46%>Retrieves the index of the mini-icon supplied for the specified class.</TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_08ky.htm"><B>SetupDiDrawMiniIcon</B></A> </TD>
<TD width=46%>Draws the specified mini-icon at the location requested.</TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_29yq.htm"><B>SetupDiLoadClassIcon</B></A> </TD>
<TD width=46%>Loads both the large and mini-icon for the specified class.</TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_8wvm.htm"><B>SetupDiDestroyClassImageList</B></A> </TD>
<TD width=46%>Destroys a class image list.</TD>
</TR>
</TABLE><BR>



<H4><A NAME="ddk_setupdi_device_interface_functions_dg"></A>SetupDi Device Interface Functions </H4>

<TABLE>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_8m42.htm"><B>SetupDiCreateDeviceInterface</B></A></TD>
<TD width=46%>Registers device functionality (a device interface) for a device.</TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_49v6.htm"><B>SetupDiOpenDeviceInterface</B></A></TD>
<TD width=46%>Retrieves information about an existing device interface and adds it to the specified device information set. </TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_76gi.htm"><B>SetupDiGetDeviceInterfaceAlias</B></A></TD>
<TD width=46%>Returns an alias of the specified device interface. </TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_9ks2.htm"><B>SetupDiGetClassDevs</B></A></TD>
<TD width=46%>Returns a device information set that contains all devices of a specified class.</TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_6msy.htm"><B>SetupDiGetClassDevsEx</B></A> </TD>
<TD width=46%>Returns a device information set that contains all devices of a specified class on a local or remote machine.</TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_1cky.htm"><B>SetupDiEnumDeviceInterfaces</B></A></TD>
<TD width=46%>Returns a context structure for a device interface element of a device information set. Each call returns information about one device interface; the function can be called repeatedly to get information about several interfaces exposed by one or more devices.</TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_6ar6.htm"><B>SetupDiGetDeviceInterfaceDetail</B></A></TD>
<TD width=46%>Returns details about a particular device interface.</TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_3gqa.htm"><B>SetupDiCreateDeviceInterfaceRegKey</B></A></TD>
<TD width=46%>Creates a registry subkey for storing information about a device interface instance and returns a handle to the key.</TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_375e.htm"><B>SetupDiOpenDeviceInterfaceRegKey</B></A></TD>
<TD width=46%>Opens the registry subkey that is used by applications and drivers to store information specific to a device interface instance and returns a handle to the key.</TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_8d4i.htm"><B>SetupDiDeleteDeviceInterfaceRegKey</B></A></TD>
<TD width=46%>Deletes the registry subkey that was used by applications and drivers to store information specific to a device interface instance. </TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_1v5e.htm"><B>SetupDiInstallDeviceInterfaces</B></A></TD>
<TD width=46%>Is the default handler for the DIF_INSTALLINTERFACES request. It installs the interfaces listed in a <I>DDInstall</I>.<B>Interfaces</B> section of a device INF file. </TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_4q2a.htm"><B>SetupDiRemoveDeviceInterface</B></A></TD>
<TD width=46%>Removes a registered device interface from the system.</TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_91f6.htm"><B>SetupDiDeleteDeviceInterfaceData</B></A></TD>
<TD width=46%>Deletes a device interface from a device information set.</TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_2ir6.htm"><B>SetupDiSetDeviceInterfaceDefault</B></A></TD>
<TD width=46%>Sets a specified device interface as the default interface for a device class.</TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_7n1u.htm"><B>SetupDiInstallClassEx</B></A></TD>
<TD width=46%>Installs a class installer or an interface class.</TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_3bea.htm"><B>SetupDiOpenClassRegKeyEx</B></A></TD>
<TD width=46%>Opens the device setup class registry key, the device interface class registry key, or a specific class's subkey. This function opens the specified key on the local machine or on a remote machine.</TD>
</TR>
</TABLE><BR>



<H4><A NAME="ddk_setupdi_registry_functions_dg"></A>SetupDi Registry Functions </H4>

<TABLE>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_6v02.htm"><B>SetupDiCreateDevRegKey</B></A> </TD>
<TD width=46%>Creates a registry storage key for device-specific configuration information and returns a handle to the key.</TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_8g36.htm"><B>SetupDiOpenDevRegKey</B></A> </TD>
<TD width=46%>Opens a registry storage key for device-specific configuration information and returns a handle to the key.</TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_8sqa.htm"><B>SetupDiDeleteDevRegKey</B></A> </TD>
<TD width=46%>Deletes the specified user-accessible registry key(s) associated with a device information element.</TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_26pe.htm"><B>SetupDiOpenClassRegKey</B></A> </TD>
<TD width=46%>Opens the setup class registry key or a specific class's subkey.</TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_3bea.htm"><B>SetupDiOpenClassRegKeyEx</B></A></TD>
<TD width=46%>Opens the device setup class registry key, the device interface class registry key, or a specific class's subkey. This function opens the specified key on the local machine or on a remote machine.</TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_3gqa.htm"><B>SetupDiCreateDeviceInterfaceRegKey</B></A></TD>
<TD width=46%>Creates a non-volatile registry subkey for storing information about a device interface instance and returns a handle to the key.</TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_375e.htm"><B>SetupDiOpenDeviceInterfaceRegKey</B></A></TD>
<TD width=46%>Opens the registry subkey that is used by applications and drivers to store information specific to a device interface instance and returns a handle to the key.</TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_8d4i.htm"><B>SetupDiDeleteDeviceInterfaceRegKey</B></A></TD>
<TD width=46%>Deletes the registry subkey that was used by applications and drivers to store information specific to a device interface instance. </TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_18c2.htm"><B>SetupDiSetDeviceRegistryProperty</B></A> </TD>
<TD width=46%>Sets the specified Plug and Play device property.</TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_4x2q.htm"><B>SetupDiGetDeviceRegistryProperty</B></A> </TD>
<TD width=46%>Retrieves the specified Plug and Play device property.</TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_6tiq.htm"><B>SetupDiGetClassRegistryProperty</B></A></TD>
<TD width=46%>Retrieves a specified device class property from the registry.</TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_6rg2.htm"><B>SetupDiSetClassRegistryProperty</B></A></TD>
<TD width=46%>Sets a specified device class property in the registry.</TD>
</TR>
</TABLE><BR>



<H4><A NAME="ddk_other_setupdi_functions_dg"></A>Other SetupDi Functions </H4>

<TABLE>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_47oy.htm"><B>SetupDiGetActualSectionToInstall</B></A> </TD>
<TD width=46%>Retrieves the appropriate <I>DDInstall</I> section to use when installing a device from a device INF file.</TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_7otu.htm"><B>SetupDiGetActualSectiontoInstallEx</B></A></TD>
<TD width=46%>Retrieves the name of the INF <I>DDInstall</I> section that installs a device for a specified operating system and processor architecture. </TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_0qya.htm"><B>SetupDiGetHwProfileFriendlyName</B></A> </TD>
<TD width=46%>Retrieves the friendly name associated with a hardware profile ID.</TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_4yr6.htm"><B>SetupDiGetHwProfileFriendlyNameEx</B></A> </TD>
<TD width=46%>Retrieves the friendly name associated with a hardware profile ID on a local or remote machine.</TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_9kvm.htm"><B>SetupDiGetHwProfileList</B></A> </TD>
<TD width=46%>Retrieves a list of all currently defined hardware profile IDs.</TD>
</TR>

<TR VALIGN="top">
<TD width=54%><A HREF="di-rtns_7vci.htm"><B>SetupDiGetHwProfileListEx</B></A> </TD>
<TD width=46%>Retrieves a list of all currently defined hardware profile IDs on a local or remote machine.</TD>
</TR>
</TABLE><BR>
<DIV CLASS="footer"><A HREF="mailto:ddksurv1@microsoft.com?subject=DDK Topic Feedback&body=Build date: Thursday, January 16, 2003     Topic Title: Using%20Device%20Installation%20Functions"> Send feedback on this topic.</A> / Built on Thursday, January 16, 2003 </DIV>
</BODY>
</HTML>
